<cue-list>
    <style>
        .cue-container {
            padding: 5px;
            margin: 5px;
            width: "100%";
            background-color: #ddd;
        }
    </style>

    <h1><b>{props.project.name}</b>: cue list</h1>
    <p>name: {props.cuelist.name}</p>
    <div>
        <div>
            <button onclick={triggerPause}>pause all</button>
        </div>
        <div class="row cue-container">
            <div class="column column-30"><b>Label</b></div>
            <div class="column column-50"><b>Mapping</b></div>
            <div class="column column-20"><b>Action</b></div>
        </div>
        <div class="row cue-container" each={ cue in props.cuelist.cues }>
            <div class="column column-30">{cue.label}</div>
            <div class="column column-50">
                <div each={mapping in cue.mappings}>{mapping.virtual_device_id + " -> " + mapping.scene_id}</div>
            </div>
            <div class="column column-20">
                <button data-id={cue.id} onclick={triggerCue}>Go</button>
            </div>
        </div>
    <div>
    
    <script>
        export default {
            state: {},
            async onBeforeMount(props, state) {},
            async triggerCue(e) {
                e.preventDefault();
                const data = {
                    projectId: this.props.projectId,
                    cuelistId: this.props.cuelist.id,
                    cueId: e.target.dataset.id
                };
                try {
                    const res = await fetch(`/api/project/trigger`, {
                        method: 'post',
                        body: JSON.stringify(data)
                    });
                    const json = await res.json();
                } catch (error) {
                    console.log({ error });
                }
            },
            async triggerPause(e) {
                e.preventDefault();
                const data = { projectId: this.props.projectId };
                try {
                    const res = await fetch(`/api/project/pause`, {
                        method: 'post',
                        body: JSON.stringify(data)
                    });
                    const json = await res.json();
                } catch (error) {
                    console.log({ error });
                }
            }
        }
    </script>
</cue-list>
